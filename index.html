<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>St Catherine's Poetry Playground</title>
  <style>
    body {
      font-family: 'Avenir Next', 'Segoe UI', 'Helvetica Neue', sans-serif;
      background: url('https://raw.githubusercontent.com/umcauley-png/poetry-playgrounds/refs/heads/main/a%20playground%20that%20i%20can%20use%20as%20a%20background.jpg') no-repeat center center fixed;
      background-size: cover;
      color: #172c66;
      text-align: center;
      padding: 40px 20px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
    }

    h1 {
      color: #2c3e50;
      background-color: rgba(255, 255, 255, 0.8);
      display: inline-block;
      padding: 10px 20px;
      border-radius: 12px;
      margin-bottom: 0.2em;
    }

    p#subtitle {
      margin-top: 0;
      font-weight: 600;
      margin-bottom: 20px;
      color: #34495e;
    }

    .poem-box {
      margin-top: 40px;
      font-size: 1.8rem;
      background-color: rgba(214, 246, 214, 0.95);
      border: 6px double #8bd3dd;
      padding: 30px;
      border-radius: 20px;
      min-height: 160px;
      width: 380px;
      max-width: 90vw;
      position: relative;
      color: #172c66;
      box-shadow: 0 0 12px rgba(0,0,0,0.15);
      white-space: pre-line;
      user-select: text;
      overflow-wrap: break-word;
    }

    .poem-line {
      opacity: 0;
      transform: translateY(10px);
      animation: fadeInUp 0.6s forwards;
    }

    @keyframes fadeInUp {
      0% { opacity: 0; transform: translateY(10px); }
      100% { opacity: 1; transform: translateY(0); }
    }

    button {
      background-color: #ffb703;
      border: none;
      padding: 15px 30px;
      font-size: 1.5rem;
      margin: 15px 10px 20px 10px;
      border-radius: 10px;
      cursor: pointer;
      transition: background 0.3s ease;
      font-family: inherit;
    }

    button:hover {
      background-color: #fb8500;
    }

    #copyButton {
      background-color: #4caf50;
    }
    #copyButton:hover {
      background-color: #3a8a38;
    }

    textarea {
      margin-top: 15px;
      width: 380px;
      max-width: 90vw;
      height: 80px;
      font-size: 1rem;
      border-radius: 8px;
      border: 2px solid #8bd3dd;
      padding: 10px;
      resize: vertical;
      font-family: inherit;
    }

    label {
      display: block;
      margin-top: 20px;
      font-weight: bold;
      color: #172c66;
    }

    #sparklesContainer {
      position: absolute;
      pointer-events: none;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      border-radius: 15px;
      overflow: visible;
      z-index: 10;
    }

    .sparkle {
      position: absolute;
      border-radius: 50%;
      opacity: 0.8;
      animation: twinkle 2s infinite ease-in-out;
      filter: drop-shadow(0 0 2px currentColor);
    }

    @keyframes twinkle {
      0%, 100% { opacity: 0.8; }
      50% { opacity: 0.2; }
    }
  </style>
</head>
<body>
  <h1>St Catherine's Poetry Playground</h1>
  <p id="subtitle">Click the button to create your own poem!</p>

  <div class="poem-box" id="poemBox" contenteditable="true">
    Your poem will appear here...
    <div id="sparklesContainer"></div>
  </div>

  <label for="userLine">Add your own line (optional):</label>
  <textarea id="userLine" placeholder="Type your line here..."></textarea>

  <div>
    <button onclick="generatePoem()">Make a Poem</button>
    <button id="copyButton" onclick="copyPoem()">Copy Poem</button>
  </div>

  <audio id="chimeSound" src="magic_chime.flac" preload="auto"></audio>

  <script>
    const wordBanks = {
      who: [
        "A golden fox", "The quiet owl", "A tiny mouse", "The brave lion",
        "A dragon", "The moon", "A playful dolphin", "A soaring eagle",
        "The gentle horse", "A curious rabbit", "A wise turtle", "The silver wolf"
      ],
      action: [
        "dances", "sings", "jumps", "twirls", "leaps",
        "glides", "whispers", "paints", "wanders", "dreams",
        "runs", "flies", "hides", "laughs", "swims"
      ],
      where: [
        "in the rain", "on a rainbow", "under the stars", "on a flying cloud",
        "through the jungle", "beside a waterfall", "with a magic brush",
        "on a mountain top", "by the ocean", "in a secret garden",
        "across the endless desert", "under the bright moonlight"
      ],
      adjectives: [
        "shimmering", "silent", "gentle", "mysterious", "golden",
        "tiny", "brave", "curious", "silver", "wild"
      ]
    };

    const additionalLines = [
      "Where dreams come alive",
      "In a small pocket of wonder",
      "And everything whispers back",
      "As the night tilts its hat",
      "Beneath a glittering hush",
      "As the meadow drifts to sleep",
      "Where oceans guard their secrets",
      "Until the golden sun returns",
      "As mountains whisper low",
      "Where the horizon melts away",
      "Until tomorrowâ€™s song begins",
      "As fireflies light the dark",
      "Where time forgets to move"
    ];

    function getRandom(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

    function generateRandomPoem(userLine){
      const adj = Math.random() < 0.4 ? getRandom(wordBanks.adjectives) + " " : "";
      const line1 = (adj + getRandom(wordBanks.who)).replace(/^\w/, c => c.toUpperCase());
      const line2 = getRandom(wordBanks.action);
      const line3 = getRandom(wordBanks.where);
      let lines = [line1, line2, line3];
      if(userLine.trim()) lines.push(userLine.trim());
      lines.push(getRandom(additionalLines));
      return lines;
    }

    function generatePoem(){
      const userLine = document.getElementById('userLine').value;
      const poemBox = document.getElementById('poemBox');
      const sparkles = document.getElementById('sparklesContainer');
      const lines = generateRandomPoem(userLine);

      poemBox.innerHTML = lines.map((line, i) =>
        `<div class="poem-line" style="animation-delay:${i*0.5}s">${line}</div>`
      ).join("") + sparkles.outerHTML;

      const sound = document.getElementById("chimeSound");
      if(sound){ sound.currentTime = 0; sound.play(); }

      createSparkles();
    }

    function copyPoem(){
      const text = Array.from(document.querySelectorAll('.poem-line'))
        .map(line => line.textContent).join("\n");
      navigator.clipboard.writeText(text).then(()=>alert('Poem copied!'));
    }

    function createSparkles(){
      const container=document.getElementById('sparklesContainer');
      container.innerHTML='';
      const colors=['#FFD700','#FF69B4','#00FFFF','#FF4500','#7CFC00','#FF00FF'];
      for(let i=0;i<20;i++){
        const sparkle=document.createElement('div');
        sparkle.classList.add('sparkle');
        sparkle.style.width=sparkle.style.height=`${Math.random()*8+4}px`;
        sparkle.style.backgroundColor=getRandom(colors);
        const edge=Math.floor(Math.random()*4);
        let x,y;
        switch(edge){
          case 0: x=Math.random()*container.clientWidth; y=Math.random()*10; break;
          case 1: x=container.clientWidth-Math.random()*10; y=Math.random()*container.clientHeight; break;
          case 2: x=Math.random()*container.clientWidth; y=container.clientHeight-Math.random()*10; break;
          case 3: x=Math.random()*10; y=Math.random()*container.clientHeight; break;
        }
        sparkle.style.left=`${x}px`; sparkle.style.top=`${y}px`;
        sparkle.style.animationDuration=(Math.random()*2+1)+'s';
        container.appendChild(sparkle);
      }
    }

    window.addEventListener('load',()=>{createSparkles();});
    window.addEventListener('resize',()=>{createSparkles();});
  </script>
</body>
</html>
