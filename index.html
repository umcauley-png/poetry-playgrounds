<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>St Catherine's Poetry Playground â€” Random Only</title>
  <style>
    body {
      font-family: 'Avenir Next', 'Segoe UI', 'Helvetica Neue', sans-serif;
      background: url('https://raw.githubusercontent.com/umcauley-png/poetry-playgrounds/refs/heads/main/a%20playground%20that%20i%20can%20use%20as%20a%20background.jpg') no-repeat center center fixed;
      background-size: cover;
      color: #172c66;
      text-align: center;
      padding: 40px 20px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
    }

    h1 {
      color: #f582ae;
      background-color: rgba(255, 255, 255, 0.8);
      display: inline-block;
      padding: 10px 20px;
      border-radius: 12px;
      margin-bottom: 0.2em;
    }

    p#subtitle {
      margin-top: 0;
      font-weight: 600;
      margin-bottom: 20px;
      color: #444;
    }

    .poem-box {
      margin-top: 40px;
      font-size: 1.8rem;
      background-color: rgba(214, 246, 214, 0.9);
      border: 4px dashed #8bd3dd;
      padding: 30px;
      border-radius: 15px;
      min-height: 160px;
      width: 380px;
      max-width: 90vw;
      position: relative;
      color: #172c66;
      box-shadow: 0 0 12px rgba(0,0,0,0.15);
      white-space: pre-line;
      user-select: text;
    }

    .bounce {
      animation: bounce 0.6s;
    }

    @keyframes bounce {
      0% { transform: scale(1); }
      30% { transform: scale(1.1); }
      50% { transform: scale(0.95); }
      70% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    button {
      background-color: #ffb703;
      border: none;
      padding: 15px 30px;
      font-size: 1.5rem;
      margin: 15px 10px 30px 10px;
      border-radius: 10px;
      cursor: pointer;
      transition: background 0.3s ease;
      font-family: inherit;
    }

    button:hover {
      background-color: #fb8500;
    }

    #copyButton {
      background-color: #4caf50;
    }
    #copyButton:hover {
      background-color: #3a8a38;
    }

    #sparklesContainer {
      position: absolute;
      pointer-events: none;
      width: 350px;
      height: 180px;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      border-radius: 15px;
      overflow: visible;
      z-index: 10;
    }

    .sparkle {
      position: absolute;
      border-radius: 50%;
      opacity: 0.8;
      animation: twinkle 2s infinite ease-in-out;
      filter: drop-shadow(0 0 2px currentColor);
    }

    @keyframes twinkle {
      0%, 100% { opacity: 0.8; }
      50% { opacity: 0.2; }
    }
  </style>
</head>
<body>
  <h1>St Catherine's Poetry Playground</h1>
  <p id="subtitle">Click the button to create your own poem!</p>

  <div class="poem-box" id="poemBox">
    Your poem will appear here...
    <div id="sparklesContainer"></div>
  </div>

  <div>
    <button onclick="generatePoem()">Make a Poem</button>
    <button id="copyButton" onclick="copyPoem()">Copy Poem</button>
  </div>

  <audio id="chimeSound" src="magic_chime.mp3" preload="auto"></audio>

  <script>
    // Expanded word banks
    const wordBanks = {
      who: [
        "A gentle lion", "The striped zebra", "A wise old owl", "The playful dolphin",
        "A tiny mouse", "The glowing firefly", "A brave explorer", "The curious cat",
        "A glittering dragon", "The silver moon", "A laughing child", "The golden eagle",
        "A clever fox", "The quiet turtle", "A singing mermaid", "The mighty elephant",
        "A wandering star", "The dancing bear", "A shy unicorn", "The red kangaroo"
      ],
      action: [
        "dances swiftly", "sings softly", "jumps high", "giggles loudly",
        "spins gracefully", "whispers gently", "paints wildly", "stomps proudly",
        "dreams deeply", "twirls endlessly", "runs quickly", "flies silently",
        "hides quietly", "laughs brightly", "swims smoothly", "roars boldly",
        "hums sweetly", "tiptoes carefully", "glows warmly", "wanders freely"
      ],
      where: [
        "in the lush jungle", "on a rainbow path", "under the twinkling stars",
        "through the misty forest", "beside a sparkling waterfall",
        "with a golden brush", "in a quiet burrow", "on a snowy mountain top",
        "over a candy castle", "inside a coral reef", "by the wide ocean",
        "in a secret garden", "on a sandy savanna", "under the glowing moonlight",
        "across the windy desert", "inside a crystal cave",
        "on the frozen tundra", "beneath the jungle canopy",
        "beside the tall cliffs", "through the grassy meadow"
      ]
    };

    const additionalLines = [
      "Where dreams come alive",
      "In a pocket full of wonder",
      "And everything whispers back",
      "As the night tilts its hat",
      "Beneath a glittering hush",
      "Where secrets hide in shadows",
      "As the morning stretches awake",
      "And hope begins to bloom"
    ];

    // Small pool of poetic devices
    const personifications = [
      "as if it had feelings",
      "whispering secrets to the wind",
      "humming with hidden dreams",
      "longing for a friend",
      "singing to itself"
    ];

    function getRandom(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

    function applyDevice(line) {
      // About 1 in 6 poems will get a device on one line
      if (Math.random() < (1/6)) {
        if (Math.random() < 0.5) {
          // Personification
          return line + ", " + getRandom(personifications);
        } else {
          // Alliteration (repeat first letter)
          const words = line.split(" ");
          if (words.length > 1) {
            const firstLetter = words[1][0].toLowerCase();
            return line + " " + firstLetter + firstLetter + firstLetter;
          }
        }
      }
      return line;
    }

    function capitalizeFirst(line) {
      return line.charAt(0).toUpperCase() + line.slice(1);
    }

    function generateRandomPoem(){
      let lines = [
        getRandom(wordBanks.who),
        getRandom(wordBanks.action),
        getRandom(wordBanks.where),
        getRandom(additionalLines)
      ];

      // Ensure only one device per poem at most
      const deviceIndex = Math.floor(Math.random() * lines.length);
      lines[deviceIndex] = applyDevice(lines[deviceIndex]);

      // Capitalize the first line
      lines[0] = capitalizeFirst(lines[0]);

      return lines.join("\n");
    }

    function generatePoem(){
      const poemText = generateRandomPoem();
      const poemBox = document.getElementById('poemBox');
      poemBox.textContent = poemText;
      poemBox.classList.remove('bounce');
      void poemBox.offsetWidth;
      poemBox.classList.add('bounce');
      const sound = document.getElementById("chimeSound");
      if(sound){ sound.currentTime = 0; sound.play(); }
    }

    function copyPoem(){
      const text = document.getElementById('poemBox').textContent;
      navigator.clipboard.writeText(text).then(()=>alert('Poem copied!'));
    }

    function createSparkles(){
      const container=document.getElementById('sparklesContainer');
      container.innerHTML='';
      const colors=['#FFD700','#FF69B4','#00FFFF','#FF4500','#7CFC00','#FF00FF'];
      for(let i=0;i<20;i++){
        const sparkle=document.createElement('div');
        sparkle.classList.add('sparkle');
        sparkle.style.width=sparkle.style.height=`${Math.random()*8+4}px`;
        sparkle.style.backgroundColor=getRandom(colors);
        const edge=Math.floor(Math.random()*4);
        let x,y;
        switch(edge){
          case 0: x=Math.random()*container.clientWidth; y=Math.random()*10; break;
          case 1: x=container.clientWidth-Math.random()*10; y=Math.random()*container.clientHeight; break;
          case 2: x=Math.random()*container.clientWidth; y=container.clientHeight-Math.random()*10; break;
          case 3: x=Math.random()*10; y=Math.random()*container.clientHeight; break;
        }
        sparkle.style.left=`${x}px`; sparkle.style.top=`${y}px`;
        sparkle.style.animationDuration=(Math.random()*2+1)+'s';
        container.appendChild(sparkle);
      }
    }

    window.addEventListener('load',()=>{createSparkles();});
    window.addEventListener('resize',()=>{createSparkles();});
  </script>
</body>
</html>
